--- tiff-3.7.1/libtiff/Makefile.am.orig	2004-10-14 19:53:27.000000000 +0200
+++ tiff-3.7.1/libtiff/Makefile.am	2004-12-23 11:33:13.000000000 +0100
@@ -36,7 +36,19 @@
 libtiffinclude_HEADERS = $(HDRS)
 noinst_HEADERS = $(EXTRA_HDRS)
 
-lib_LTLIBRARIES = libtiff.la
+if HAVE_CXX
+libtiffcxx_la_SOURCES = $(CXX_SRCS)
+libtiffcxx_la_LDFLAGS = \
+	-no-undefined \
+	-version-number $(LIBTIFF_MAJOR_VERSION):$(LIBTIFF_MINOR_VERSION):$(LIBTIFF_MICRO_VERSION)
+libtiffcxx_la_LIBADD = libtiff.la
+HDRS += $(CXX_HDRS)
+tiffcxx = libtiffcxx.la
+else
+tiffcxx =
+endif
+
+lib_LTLIBRARIES = libtiff.la $(tiffcxx)
 libtiff_la_SOURCES = $(SRCS)
 libtiff_la_LDFLAGS = \
 	-no-undefined \
--- tiff-3.7.1/libtiff/files.lst.orig	2004-11-21 17:09:29.000000000 +0100
+++ tiff-3.7.1/libtiff/files.lst	2004-12-23 11:22:13.000000000 +0100
@@ -49,10 +49,8 @@
 	tif_write.c \
 	tif_zip.c
 
-if HAVE_CXX
-HDRS +=	tiffio.hxx
-SRCS += tif_stream.cxx
-endif
+CXX_HDRS = tiffio.hxx
+CXX_SRCS = tif_stream.cxx
 
 EXTRA_SRCS = \
 	tif_acorn.c \
