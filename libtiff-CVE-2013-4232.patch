commit 0583f9859af8862c5a8748cb8a2a93673a5de3d4
Author: fwarmerdam <fwarmerdam>
Date:   Wed Aug 14 05:11:36 2013 +0000

    ensure return after memory allocation failure (#2449, CVS-2013-4232)

diff --git a/ChangeLog b/ChangeLog
index 1a6c779..449555d 100644
diff --git a/tools/tiff2pdf.c b/tools/tiff2pdf.c
index 109f618..951f44b 100644
--- a/tools/tiff2pdf.c
+++ b/tools/tiff2pdf.c
@@ -2461,7 +2461,8 @@ tsize_t t2p_readwrite_pdf_image(T2P* t2p, TIFF* input, TIFF* output){
 					(unsigned long) t2p->tiff_datasize, 
 					TIFFFileName(input));
 				t2p->t2p_error = T2P_ERR_ERROR;
-			  _TIFFfree(buffer);
+				_TIFFfree(buffer);
+				return(0);
 			} else {
 				buffer=samplebuffer;
 				t2p->tiff_datasize *= t2p->tiff_samplesperpixel;
